<h2>Tables</h2>
<div class="d-flex justify-content-between mb-3" style="display:none !important;">
  <button type="button" class="btn btn-primary bt-newtable" data-toggle="modal" data-target="#tableModal">New Table</button>
</div>
<table class="table table-dark" id="tables">
  <thead>
    <tr>
      <!-- th scope="col">ID</th -->
      <th scope="col">Name</th>
      <th scope="col">Database</th>
      <th scope="col">Type</th>
    </tr>
  </thead>
  <tbody>
    </tbody>
</table>

<script>
// Update existing script to handle tables section
$(document).ready(function() {
  // ... Existing code to get hosts and databases ...
  
  // Additional code to fetch tables (assuming an endpoint exists)
  function getTables(){
    var dbid = Cookies.get("dbid");
    $.getJSON('/getTables/'+dbid, function (tables) {
      if (!Array.isArray(tables)) return; // Check for array response
      $('#tables > tbody').empty();
      for (var i in tables) {
        var table_id = tables[i].id;
        var table_name = tables[i].name;
        var table_type = tables[i].type;
        var table_database = tables[i].database_name; // Assuming foreign key for database
        var btn_a = " <button title='OPEN' class='badge bg-success bt-approve' data-idtable='"+table_id+"'><i class='bi bi-check-square-fill'></i></button>";
        var btn_d = "<button title='RESTRICT' class='badge bg-danger bt-deapprove' data-idtable='"+table_id+"'><i class='bi bi-x-square-fill'></i></button> ";
        var btn = (tables[i].type_id==0)?btn_a:btn_d;
        table_type = (tables[i].type_id==1) ? '<span class="badge bg-success"> OPEN</span>' : '<span class="badge bg-danger"> RESTRICT</span>';
        table_type = (tables[i].type_id==1) ? table_type + btn : btn + table_type;
        
        // Modify selector to target tables table
        $('#tables > tbody:last').append('<tr>'+ //<td>' + table_id + '</td>' +
          '<td>' + table_name + '</td>' +
          '<td>' + table_database + '</td>' +
          '<td>' + table_type + '</td>' +
          '</tr>');
      }
      
      $('.bt-approve, .bt-deapprove').click(function(e) {
        e.preventDefault();
        var id_table = $(this).data('idtable');
        $.getJSON('/typeChangeTable/'+id_table+'/'+(($(this).hasClass('bt-deapprove'))?'0':'1'), function () {
          getTables();
        });
      });

    });
  }
  getTables();
  // Update click event handler for new table button
  $('.bt-newtable').click(function(e) {
    e.preventDefault();
    var target = $(this).data('target');
    $('#content-area').load('tables_new.html'); // Load content for new table form
  });
});
</script>
